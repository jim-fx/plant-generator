var t,n=require("@plantarium/geometry"),i=(t=require("@plantarium/nodes"))&&"object"==typeof t&&"default"in t?t.default:t;function e(){return(e=Object.assign||function(t){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var e in i)Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e])}return t}).apply(this,arguments)}var r,o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function s(t,n){for(var i=0;i<n.length;i++){var e=n[i];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function u(t,n,i){return n&&s(t.prototype,n),i&&s(t,i),t}function h(t,n){t.prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,n){return(c=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function l(t,n,i){return(l=f()?Reflect.construct:function(t,n,i){var e=[null];e.push.apply(e,n);var r=new(Function.bind.apply(t,e));return i&&c(r,i.prototype),r}).apply(null,arguments)}function v(t){var n="function"==typeof Map?new Map:void 0;return(v=function(t){if(null===t||-1===Function.toString.call(t).indexOf("[native code]"))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,i)}function i(){return l(t,arguments,a(this).constructor)}return i.prototype=Object.create(t.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),c(i,t)})(t)}function p(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}r={path:void 0,exports:{},require:function(t,n){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}},function(){function t(t,n,i){var e=new XMLHttpRequest;e.open("GET",t),e.responseType="blob",e.onload=function(){s(e.response,n,i)},e.onerror=function(){console.error("could not download file")},e.send()}function n(t){var n=new XMLHttpRequest;n.open("HEAD",t,!1);try{n.send()}catch(t){}return 200<=n.status&&299>=n.status}function i(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(i){var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(n)}}var e="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof o&&o.global===o?o:void 0,s=e.saveAs||("object"!=typeof window||window!==e?function(){}:"download"in HTMLAnchorElement.prototype?function(r,o,s){var u=e.URL||e.webkitURL,h=document.createElement("a");h.download=o=o||r.name||"download",h.rel="noopener","string"==typeof r?(h.href=r,h.origin===location.origin?i(h):n(h.href)?t(r,o,s):i(h,h.target="_blank")):(h.href=u.createObjectURL(r),setTimeout(function(){u.revokeObjectURL(h.href)},4e4),setTimeout(function(){i(h)},0))}:"msSaveOrOpenBlob"in navigator?function(e,r,o){if(r=r||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function(t,n){return void 0===n?n={autoBom:!1}:"object"!=typeof n&&(console.warn("Deprecated: Expected third argument to be a object"),n={autoBom:!n}),n.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}(e,o),r);else if(n(e))t(e,r,o);else{var s=document.createElement("a");s.href=e,s.target="_blank",setTimeout(function(){i(s)})}}:function(n,i,r,o){if((o=o||open("","_blank"))&&(o.document.title=o.document.body.innerText="downloading..."),"string"==typeof n)return t(n,i,r);var s="application/octet-stream"===n.type,u=/constructor/i.test(e.HTMLElement)||e.safari,h=/CriOS\/[\d]+/.test(navigator.userAgent);if((h||s&&u)&&"object"==typeof FileReader){var a=new FileReader;a.onloadend=function(){var t=a.result;t=h?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=t:location=t,o=null},a.readAsDataURL(n)}else{var c=e.URL||e.webkitURL,f=c.createObjectURL(n);o?o.location=f:location.href=f,o=null,setTimeout(function(){c.revokeObjectURL(f)},4e4)}});e.saveAs=s.saveAs=s,r.exports=s}();var d=[],y=0;function w(t){var n=function(){var n;d.length&&!d.includes(t)||0!==y||(n=console).log.apply(n,["["+t+"]"].concat([].slice.call(arguments)))};return n.warn=function(){var n;y<=1&&(n=console).warn.apply(n,["["+t+"]"].concat([].slice.call(arguments)))},n.error=function(n){y<=2&&console.error("["+t+"]",n)},n}function g(t){var n=t[0],i=t[1],e=t[2];return Math.sqrt(n*n+i*i+e*e)}function m(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t}function M(t,n,i){return t[0]=n[0]+i[0],t[1]=n[1]+i[1],t[2]=n[2]+i[2],t}function b(t,n,i){return t[0]=n[0]-i[0],t[1]=n[1]-i[1],t[2]=n[2]-i[2],t}function O(t,n,i){return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t}function q(t){var n=t[0],i=t[1],e=t[2];return n*n+i*i+e*e}function k(t,n){var i=n[0],e=n[1],r=n[2],o=i*i+e*e+r*r;return o>0&&(o=1/Math.sqrt(o)),t[0]=n[0]*o,t[1]=n[1]*o,t[2]=n[2]*o,t}function j(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function x(t,n,i){var e=n[0],r=n[1],o=n[2],s=i[0],u=i[1],h=i[2];return t[0]=r*h-o*u,t[1]=o*s-e*h,t[2]=e*u-r*s,t}w.setFilter=function(){d=[].slice.call(arguments)},w.setLevel=function(t){void 0===t&&(t=0),y=t};var A,E,R=(A=[0,0,0],E=[0,0,0],function(t,n){m(A,t),m(E,n),k(A,A),k(E,E);var i=j(A,E);return i>1?0:i<-1?Math.PI:Math.acos(i)}),C=function(t){function n(n,i,e){var r;return void 0===n&&(n=0),void 0===i&&(i=n),void 0===e&&(e=n),(r=t.call(this,n,i,e)||this).constant=void 0,p(r)||p(r)}h(n,t);var i=n.prototype;return i.set=function(t,n,i){return void 0===n&&(n=t),void 0===i&&(i=t),t.length?this.copy(t):(function(t,n,i,e){t[0]=n,t[1]=i,t[2]=e}(this,t,n,i),this)},i.copy=function(t){return m(this,t),this},i.add=function(t,n){return n?M(this,t,n):M(this,this,t),this},i.sub=function(t,n){return n?b(this,t,n):b(this,this,t),this},i.multiply=function(t){var n,i;return t.length?((n=this)[0]=this[0]*(i=t)[0],n[1]=this[1]*i[1],n[2]=this[2]*i[2]):O(this,this,t),this},i.divide=function(t){var n,i;return t.length?((n=this)[0]=this[0]/(i=t)[0],n[1]=this[1]/i[1],n[2]=this[2]/i[2]):O(this,this,1/t),this},i.inverse=function(t){var n,i;return void 0===t&&(t=this),(n=this)[0]=1/(i=t)[0],n[1]=1/i[1],n[2]=1/i[2],this},i.len=function(){return g(this)},i.distance=function(t){return t?(i=(n=t)[0]-this[0],e=n[1]-this[1],r=n[2]-this[2],Math.sqrt(i*i+e*e+r*r)):g(this);var n,i,e,r},i.squaredLen=function(){return q(this)},i.squaredDistance=function(t){return t?(i=(n=t)[0]-this[0])*i+(e=n[1]-this[1])*e+(r=n[2]-this[2])*r:q(this);var n,i,e,r},i.negate=function(t){var n,i;return void 0===t&&(t=this),(n=this)[0]=-(i=t)[0],n[1]=-i[1],n[2]=-i[2],this},i.cross=function(t,n){return n?x(this,t,n):x(this,this,t),this},i.scale=function(t){return O(this,this,t),this},i.normalize=function(){return k(this,this),this},i.dot=function(t){return j(this,t)},i.equals=function(t){return this[0]===(n=t)[0]&&this[1]===n[1]&&this[2]===n[2];var n},i.applyMatrix4=function(t){var n,i,e,r,o,s;return(n=this)[0]=((i=t)[0]*(e=this[0])+i[4]*(r=this[1])+i[8]*(o=this[2])+i[12])/(s=(s=i[3]*e+i[7]*r+i[11]*o+i[15])||1),n[1]=(i[1]*e+i[5]*r+i[9]*o+i[13])/s,n[2]=(i[2]*e+i[6]*r+i[10]*o+i[14])/s,this},i.scaleRotateMatrix4=function(t){var n,i,e,r,o,s;return(n=this)[0]=((i=t)[0]*(e=this[0])+i[4]*(r=this[1])+i[8]*(o=this[2]))/(s=(s=i[3]*e+i[7]*r+i[11]*o+i[15])||1),n[1]=(i[1]*e+i[5]*r+i[9]*o)/s,n[2]=(i[2]*e+i[6]*r+i[10]*o)/s,this},i.applyQuaternion=function(t){return function(t,n,i){var e=n[0],r=n[1],o=n[2],s=i[0],u=i[1],h=i[2],a=u*o-h*r,c=h*e-s*o,f=s*r-u*e,l=u*f-h*c,v=h*a-s*f,p=s*c-u*a,d=2*i[3];c*=d,f*=d,v*=2,p*=2,t[0]=e+(a*=d)+(l*=2),t[1]=r+c+v,t[2]=o+f+p}(this,this,t),this},i.angle=function(t){return R(this,t)},i.lerp=function(t,n){return function(t,n,i,e){var r=n[0],o=n[1],s=n[2];t[0]=r+e*(i[0]-r),t[1]=o+e*(i[1]-o),t[2]=s+e*(i[2]-s)}(this,this,t,n),this},i.clone=function(){return new n(this[0],this[1],this[2])},i.fromArray=function(t,n){return void 0===n&&(n=0),this[0]=t[n],this[1]=t[n+1],this[2]=t[n+2],this},i.toArray=function(t,n){return void 0===t&&(t=[]),void 0===n&&(n=0),t[n]=this[0],t[n+1]=this[1],t[n+2]=this[2],t},i.transformDirection=function(t){var n=this[0],i=this[1],e=this[2];return this[0]=t[0]*n+t[4]*i+t[8]*e,this[1]=t[1]*n+t[5]*i+t[9]*e,this[2]=t[2]*n+t[6]*i+t[10]*e,this.normalize()},u(n,[{key:"x",get:function(){return this[0]},set:function(t){this[0]=t}},{key:"y",get:function(){return this[1]},set:function(t){this[1]=t}},{key:"z",get:function(){return this[2]},set:function(t){this[2]=t}}]),n}(v(Array));function L(t,n,i){var e=n[0],r=n[1],o=n[2],s=n[3],u=n[4],h=n[5],a=n[6],c=n[7],f=n[8],l=n[9],v=n[10],p=n[11],d=n[12],y=n[13],w=n[14],g=n[15],m=i[0],M=i[1],b=i[2],O=i[3];return t[0]=m*e+M*u+b*f+O*d,t[1]=m*r+M*h+b*l+O*y,t[2]=m*o+M*a+b*v+O*w,t[3]=m*s+M*c+b*p+O*g,t[4]=(m=i[4])*e+(M=i[5])*u+(b=i[6])*f+(O=i[7])*d,t[5]=m*r+M*h+b*l+O*y,t[6]=m*o+M*a+b*v+O*w,t[7]=m*s+M*c+b*p+O*g,t[8]=(m=i[8])*e+(M=i[9])*u+(b=i[10])*f+(O=i[11])*d,t[9]=m*r+M*h+b*l+O*y,t[10]=m*o+M*a+b*v+O*w,t[11]=m*s+M*c+b*p+O*g,t[12]=(m=i[12])*e+(M=i[13])*u+(b=i[14])*f+(O=i[15])*d,t[13]=m*r+M*h+b*l+O*y,t[14]=m*o+M*a+b*v+O*w,t[15]=m*s+M*c+b*p+O*g,t}function _(t,n){var i=n[4],e=n[5],r=n[6],o=n[8],s=n[9],u=n[10];return t[0]=Math.hypot(n[0],n[1],n[2]),t[1]=Math.hypot(i,e,r),t[2]=Math.hypot(o,s,u),t}new C,new C;var S,T=(S=[0,0,0],function(t,n){var i=S;_(i,n);var e=1/i[0],r=1/i[1],o=1/i[2],s=n[0]*e,u=n[1]*r,h=n[2]*o,a=n[4]*e,c=n[5]*r,f=n[6]*o,l=n[8]*e,v=n[9]*r,p=n[10]*o,d=s+c+p,y=0;return d>0?(y=2*Math.sqrt(d+1),t[3]=.25*y,t[0]=(f-v)/y,t[1]=(l-h)/y,t[2]=(u-a)/y):s>c&&s>p?(y=2*Math.sqrt(1+s-c-p),t[3]=(f-v)/y,t[0]=.25*y,t[1]=(u+a)/y,t[2]=(l+h)/y):c>p?(y=2*Math.sqrt(1+c-s-p),t[3]=(l-h)/y,t[0]=(u+a)/y,t[1]=.25*y,t[2]=(f+v)/y):(y=2*Math.sqrt(1+p-s-c),t[3]=(u-a)/y,t[0]=(l+h)/y,t[1]=(f+v)/y,t[2]=.25*y),t}),P=function(t){function n(n,i,e,r,o,s,u,h,a,c,f,l,v,d,y,w){var g;return void 0===n&&(n=1),void 0===i&&(i=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===o&&(o=0),void 0===s&&(s=1),void 0===u&&(u=0),void 0===h&&(h=0),void 0===a&&(a=0),void 0===c&&(c=0),void 0===f&&(f=1),void 0===l&&(l=0),void 0===v&&(v=0),void 0===d&&(d=0),void 0===y&&(y=0),void 0===w&&(w=1),p(g=t.call(this,n,i,e,r,o,s,u,h,a,c,f,l,v,d,y,w)||this)||p(g)}h(n,t);var i=n.prototype;return i.set=function(t,n,i,e,r,o,s,u,h,a,c,f,l,v,p,d){return t.length?this.copy(t):(function(t,n,i,e,r,o,s,u,h,a,c,f,l,v,p,d,y){t[0]=n,t[1]=i,t[2]=e,t[3]=r,t[4]=o,t[5]=s,t[6]=u,t[7]=h,t[8]=a,t[9]=c,t[10]=f,t[11]=l,t[12]=v,t[13]=p,t[14]=d,t[15]=y}(this,t,n,i,e,r,o,s,u,h,a,c,f,l,v,p,d),this)},i.translate=function(t,n){return void 0===n&&(n=this),function(t,n,i){var e,r,o,s,u,h,a,c,f,l,v,p,d=i[0],y=i[1],w=i[2];n===t?(t[12]=n[0]*d+n[4]*y+n[8]*w+n[12],t[13]=n[1]*d+n[5]*y+n[9]*w+n[13],t[14]=n[2]*d+n[6]*y+n[10]*w+n[14],t[15]=n[3]*d+n[7]*y+n[11]*w+n[15]):(r=n[1],o=n[2],s=n[3],u=n[4],h=n[5],a=n[6],c=n[7],f=n[8],l=n[9],v=n[10],p=n[11],t[0]=e=n[0],t[1]=r,t[2]=o,t[3]=s,t[4]=u,t[5]=h,t[6]=a,t[7]=c,t[8]=f,t[9]=l,t[10]=v,t[11]=p,t[12]=e*d+u*y+f*w+n[12],t[13]=r*d+h*y+l*w+n[13],t[14]=o*d+a*y+v*w+n[14],t[15]=s*d+c*y+p*w+n[15])}(this,n,t),this},i.rotate=function(t,n,i){return void 0===i&&(i=this),function(t,n,i,e){var r,o,s,u,h,a,c,f,l,v,p,d,y,w,g,m,M,b,O,q,k,j,x,A,E=e[0],R=e[1],C=e[2],L=Math.hypot(E,R,C);Math.abs(L)<1e-6||(E*=L=1/L,R*=L,C*=L,r=Math.sin(i),o=Math.cos(i),h=n[1],a=n[2],c=n[3],l=n[5],v=n[6],p=n[7],y=n[9],w=n[10],g=n[11],O=E*R*(s=1-o)-C*r,q=R*R*s+o,k=C*R*s+E*r,j=E*C*s+R*r,x=R*C*s-E*r,A=C*C*s+o,t[0]=(u=n[0])*(m=E*E*s+o)+(f=n[4])*(M=R*E*s+C*r)+(d=n[8])*(b=C*E*s-R*r),t[1]=h*m+l*M+y*b,t[2]=a*m+v*M+w*b,t[3]=c*m+p*M+g*b,t[4]=u*O+f*q+d*k,t[5]=h*O+l*q+y*k,t[6]=a*O+v*q+w*k,t[7]=c*O+p*q+g*k,t[8]=u*j+f*x+d*A,t[9]=h*j+l*x+y*A,t[10]=a*j+v*x+w*A,t[11]=c*j+p*x+g*A,n!==t&&(t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]))}(this,i,t,n),this},i.scale=function(t,n){return void 0===n&&(n=this),function(t,n,i){var e=i[0],r=i[1],o=i[2];t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=n[3]*e,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=n[7]*r,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=n[11]*o,t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]}(this,n,"number"==typeof t?[t,t,t]:t),this},i.multiply=function(t,n){return n?L(this,t,n):L(this,this,t),this},i.identity=function(){var t;return(t=this)[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},i.copy=function(t){var n,i;return(n=this)[0]=(i=t)[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this},i.fromPerspective=function(t){var n,i,e,r,o,s,u=void 0===t?{}:t;return n=this,i=u.aspect,e=u.near,r=u.far,o=1/Math.tan(u.fov/2),s=1/(e-r),n[0]=o/i,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=o,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=(r+e)*s,n[11]=-1,n[12]=0,n[13]=0,n[14]=2*r*e*s,n[15]=0,this},i.fromOrthogonal=function(t){return a=1/((r=t.bottom)-(o=t.top)),c=1/((s=t.near)-(u=t.far)),(n=this)[0]=-2*(h=1/((i=t.left)-(e=t.right))),n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*a,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*c,n[11]=0,n[12]=(i+e)*h,n[13]=(o+r)*a,n[14]=(u+s)*c,n[15]=1,this;var n,i,e,r,o,s,u,h,a,c},i.fromQuaternion=function(t){return function(t,n){var i=n[0],e=n[1],r=n[2],o=n[3],s=i+i,u=e+e,h=r+r,a=i*s,c=e*s,f=e*u,l=r*s,v=r*u,p=r*h,d=o*s,y=o*u,w=o*h;t[0]=1-f-p,t[1]=c+w,t[2]=l-y,t[3]=0,t[4]=c-w,t[5]=1-a-p,t[6]=v+d,t[7]=0,t[8]=l+y,t[9]=v-d,t[10]=1-a-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(this,t),this},i.setPosition=function(t){return this.x=t[0],this.y=t[1],this.z=t[2],this},i.inverse=function(t){var n,i,e,r,o,s,u,h,a,c,f,l,v,p,d,y,w,g,m,M,b,O,q,k,j,x,A,E,R,C,L;return void 0===t&&(t=this),n=this,(L=(m=(e=(i=t)[0])*(h=i[5])-(r=i[1])*(u=i[4]))*(C=(v=i[10])*(g=i[15])-(p=i[11])*(w=i[14]))-(M=e*(a=i[6])-(o=i[2])*u)*(R=(l=i[9])*g-p*(y=i[13]))+(b=e*(c=i[7])-(s=i[3])*u)*(E=l*w-v*y)+(O=r*a-o*h)*(A=(f=i[8])*g-p*(d=i[12]))-(q=r*c-s*h)*(x=f*w-v*d)+(k=o*c-s*a)*(j=f*y-l*d))&&(n[0]=(h*C-a*R+c*E)*(L=1/L),n[1]=(o*R-r*C-s*E)*L,n[2]=(y*k-w*q+g*O)*L,n[3]=(v*q-l*k-p*O)*L,n[4]=(a*A-u*C-c*x)*L,n[5]=(e*C-o*A+s*x)*L,n[6]=(w*b-d*k-g*M)*L,n[7]=(f*k-v*b+p*M)*L,n[8]=(u*R-h*A+c*j)*L,n[9]=(r*A-e*R-s*j)*L,n[10]=(d*q-y*b+g*m)*L,n[11]=(l*b-f*q-p*m)*L,n[12]=(h*x-u*E-a*j)*L,n[13]=(e*E-r*x+o*j)*L,n[14]=(y*M-d*O-w*m)*L,n[15]=(f*O-l*M+v*m)*L),this},i.compose=function(t,n,i){return function(t,n,i,e){var r=n[0],o=n[1],s=n[2],u=n[3],h=r+r,a=o+o,c=s+s,f=r*h,l=r*a,v=r*c,p=o*a,d=o*c,y=s*c,w=u*h,g=u*a,m=u*c,M=e[0],b=e[1],O=e[2];t[0]=(1-(p+y))*M,t[1]=(l+m)*M,t[2]=(v-g)*M,t[3]=0,t[4]=(l-m)*b,t[5]=(1-(f+y))*b,t[6]=(d+w)*b,t[7]=0,t[8]=(v+g)*O,t[9]=(d-w)*O,t[10]=(1-(f+p))*O,t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1}(this,t,n,i),this},i.getRotation=function(t){return T(t,this),this},i.getTranslation=function(t){var n;return(n=t)[0]=this[12],n[1]=this[13],n[2]=this[14],this},i.getScaling=function(t){return _(t,this),this},i.getMaxScaleOnAxis=function(){return t=this[0],n=this[1],i=this[2],e=this[4],r=this[5],o=this[6],s=this[8],u=this[9],h=this[10],Math.sqrt(Math.max(t*t+n*n+i*i,e*e+r*r+o*o,s*s+u*u+h*h));var t,n,i,e,r,o,s,u,h},i.lookAt=function(t,n,i){return function(t,n,i,e){var r=n[0],o=n[1],s=n[2],u=e[0],h=e[1],a=e[2],c=r-i[0],f=o-i[1],l=s-i[2],v=c*c+f*f+l*l;0===v?l=1:(c*=v=1/Math.sqrt(v),f*=v,l*=v);var p=h*l-a*f,d=a*c-u*l,y=u*f-h*c;0==(v=p*p+d*d+y*y)&&(a?u+=1e-6:h?a+=1e-6:h+=1e-6,v=(p=h*l-a*f)*p+(d=a*c-u*l)*d+(y=u*f-h*c)*y),d*=v=1/Math.sqrt(v),y*=v,t[0]=p*=v,t[1]=d,t[2]=y,t[3]=0,t[4]=f*y-l*d,t[5]=l*p-c*y,t[6]=c*d-f*p,t[7]=0,t[8]=c,t[9]=f,t[10]=l,t[11]=0,t[12]=r,t[13]=o,t[14]=s,t[15]=1}(this,t,n,i),this},i.determinant=function(){return((n=(t=this)[0])*(s=t[5])-(i=t[1])*(o=t[4]))*((f=t[10])*(y=t[15])-(l=t[11])*(d=t[14]))-(n*(u=t[6])-(e=t[2])*o)*((c=t[9])*y-l*(p=t[13]))+(n*(h=t[7])-(r=t[3])*o)*(c*d-f*p)+(i*u-e*s)*((a=t[8])*y-l*(v=t[12]))-(i*h-r*s)*(a*d-f*v)+(e*h-r*u)*(a*p-c*v);var t,n,i,e,r,o,s,u,h,a,c,f,l,v,p,d,y},i.fromArray=function(t,n){return void 0===n&&(n=0),this[0]=t[n],this[1]=t[n+1],this[2]=t[n+2],this[3]=t[n+3],this[4]=t[n+4],this[5]=t[n+5],this[6]=t[n+6],this[7]=t[n+7],this[8]=t[n+8],this[9]=t[n+9],this[10]=t[n+10],this[11]=t[n+11],this[12]=t[n+12],this[13]=t[n+13],this[14]=t[n+14],this[15]=t[n+15],this},i.toArray=function(t,n){return void 0===t&&(t=[]),void 0===n&&(n=0),t[n]=this[0],t[n+1]=this[1],t[n+2]=this[2],t[n+3]=this[3],t[n+4]=this[4],t[n+5]=this[5],t[n+6]=this[6],t[n+7]=this[7],t[n+8]=this[8],t[n+9]=this[9],t[n+10]=this[10],t[n+11]=this[11],t[n+12]=this[12],t[n+13]=this[13],t[n+14]=this[14],t[n+15]=this[15],t},u(n,[{key:"x",get:function(){return this[12]},set:function(t){this[12]=t}},{key:"y",get:function(){return this[13]},set:function(t){this[13]=t}},{key:"z",get:function(){return this[14]},set:function(t){this[14]=t}},{key:"w",get:function(){return this[15]},set:function(t){this[15]=t}}]),n}(v(Array));function D(t,n,i){var e=n[0],r=n[1],o=n[2],s=n[3],u=i[0],h=i[1],a=i[2],c=i[3];return t[0]=e*c+s*u+r*a-o*h,t[1]=r*c+s*h+o*u-e*a,t[2]=o*c+s*a+e*h-r*u,t[3]=s*c-e*u-r*h-o*a,t}var U=function(t){function n(n,i,e,r){var o;return void 0===n&&(n=0),void 0===i&&(i=0),void 0===e&&(e=0),void 0===r&&(r=1),(o=t.call(this,n,i,e,r)||this).onChange=void 0,o.onChange=function(){},p(o)||p(o)}h(n,t);var i=n.prototype;return i.identity=function(){var t;return(t=this)[0]=0,t[1]=0,t[2]=0,t[3]=1,this.onChange(),this},i.set=function(t,n,i,e){return t.length?this.copy(t):(function(t,n,i,e,r){t[0]=n,t[1]=i,t[2]=e,t[3]=r}(this,t,n,i,e),this.onChange(),this)},i.rotateX=function(t){return function(t,n,i){i*=.5;var e=n[0],r=n[1],o=n[2],s=n[3],u=Math.sin(i),h=Math.cos(i);t[0]=e*h+s*u,t[1]=r*h+o*u,t[2]=o*h-r*u,t[3]=s*h-e*u}(this,this,t),this.onChange(),this},i.rotateY=function(t){return function(t,n,i){i*=.5;var e=n[0],r=n[1],o=n[2],s=n[3],u=Math.sin(i),h=Math.cos(i);t[0]=e*h-o*u,t[1]=r*h+s*u,t[2]=o*h+e*u,t[3]=s*h-r*u}(this,this,t),this.onChange(),this},i.rotateZ=function(t){return function(t,n,i){i*=.5;var e=n[0],r=n[1],o=n[2],s=n[3],u=Math.sin(i),h=Math.cos(i);t[0]=e*h+r*u,t[1]=r*h-e*u,t[2]=o*h+s*u,t[3]=s*h-o*u}(this,this,t),this.onChange(),this},i.inverse=function(t){var n,i,e,r,o,s,u,h;return void 0===t&&(t=this),(n=this)[0]=-(e=(i=t)[0])*(h=(u=e*e+(r=i[1])*r+(o=i[2])*o+(s=i[3])*s)?1/u:0),n[1]=-r*h,n[2]=-o*h,n[3]=s*h,this.onChange(),this},i.conjugate=function(t){var n,i;return void 0===t&&(t=this),(n=this)[0]=-(i=t)[0],n[1]=-i[1],n[2]=-i[2],n[3]=i[3],this.onChange(),this},i.copy=function(t){return(n=this)[0]=(i=t)[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],this.onChange(),this;var n,i},i.normalize=function(t){return void 0===t&&(t=this),(s=(i=(n=t)[0])*i+(e=n[1])*e+(r=n[2])*r+(o=n[3])*o)>0&&(s=1/Math.sqrt(s)),this[0]=i*s,this[1]=e*s,this[2]=r*s,this[3]=o*s,this.onChange(),this;var n,i,e,r,o,s},i.multiply=function(t,n){return n?D(this,t,n):D(this,this,t),this.onChange(),this},i.dot=function(t){return(n=this)[0]*(i=t)[0]+n[1]*i[1]+n[2]*i[2]+n[3]*i[3];var n,i},i.fromMatrix3=function(t){return function(t,n){var i,e=n[0]+n[4]+n[8];if(e>0)i=Math.sqrt(e+1),t[3]=.5*i,t[0]=(n[5]-n[7])*(i=.5/i),t[1]=(n[6]-n[2])*i,t[2]=(n[1]-n[3])*i;else{var r=0;n[4]>n[0]&&(r=1),n[8]>n[3*r+r]&&(r=2);var o=(r+1)%3,s=(r+2)%3;i=Math.sqrt(n[3*r+r]-n[3*o+o]-n[3*s+s]+1),t[r]=.5*i,t[3]=(n[3*o+s]-n[3*s+o])*(i=.5/i),t[o]=(n[3*o+r]+n[3*r+o])*i,t[s]=(n[3*s+r]+n[3*r+s])*i}}(this,t),this.onChange(),this},i.fromEuler=function(t){return function(t,n,i){void 0===i&&(i="YXZ");var e=Math.sin(.5*n[0]),r=Math.cos(.5*n[0]),o=Math.sin(.5*n[1]),s=Math.cos(.5*n[1]),u=Math.sin(.5*n[2]),h=Math.cos(.5*n[2]);"XYZ"===i?(t[0]=e*s*h+r*o*u,t[1]=r*o*h-e*s*u,t[2]=r*s*u+e*o*h,t[3]=r*s*h-e*o*u):"YXZ"===i?(t[0]=e*s*h+r*o*u,t[1]=r*o*h-e*s*u,t[2]=r*s*u-e*o*h,t[3]=r*s*h+e*o*u):"ZXY"===i?(t[0]=e*s*h-r*o*u,t[1]=r*o*h+e*s*u,t[2]=r*s*u+e*o*h,t[3]=r*s*h-e*o*u):"ZYX"===i?(t[0]=e*s*h-r*o*u,t[1]=r*o*h+e*s*u,t[2]=r*s*u-e*o*h,t[3]=r*s*h+e*o*u):"YZX"===i?(t[0]=e*s*h+r*o*u,t[1]=r*o*h+e*s*u,t[2]=r*s*u-e*o*h,t[3]=r*s*h-e*o*u):"XZY"===i&&(t[0]=e*s*h-r*o*u,t[1]=r*o*h-e*s*u,t[2]=r*s*u+e*o*h,t[3]=r*s*h+e*o*u)}(this,t,t.order),this},i.fromAxisAngle=function(t,n){return function(t,n,i){i*=.5;var e=Math.sin(i);t[0]=e*n[0],t[1]=e*n[1],t[2]=e*n[2],t[3]=Math.cos(i)}(this,t,n),this},i.slerp=function(t,n){return function(t,n,i,e){var r,o,s,u,h,a=n[0],c=n[1],f=n[2],l=n[3],v=i[0],p=i[1],d=i[2],y=i[3];(o=a*v+c*p+f*d+l*y)<0&&(o=-o,v=-v,p=-p,d=-d,y=-y),1-o>1e-6?(r=Math.acos(o),s=Math.sin(r),u=Math.sin((1-e)*r)/s,h=Math.sin(e*r)/s):(u=1-e,h=e),t[0]=u*a+h*v,t[1]=u*c+h*p,t[2]=u*f+h*d,t[3]=u*l+h*y}(this,this,t,n),this},i.fromArray=function(t,n){return void 0===n&&(n=0),this[0]=t[n],this[1]=t[n+1],this[2]=t[n+2],this[3]=t[n+3],this},i.toArray=function(t,n){return void 0===t&&(t=[]),void 0===n&&(n=0),t[n]=this[0],t[n+1]=this[1],t[n+2]=this[2],t[n+3]=this[3],t},u(n,[{key:"x",get:function(){return this[0]},set:function(t){this[0]=t,this.onChange()}},{key:"y",get:function(){return this[1]},set:function(t){this[1]=t,this.onChange()}},{key:"z",get:function(){return this[2]},set:function(t){this[2]=t,this.onChange()}},{key:"w",get:function(){return this[3]},set:function(t){this[3]=t,this.onChange()}}]),n}(v(Array));function X(t,n,i){return t[0]=n[0]+i[0],t[1]=n[1]+i[1],t}function z(t,n,i){return t[0]=n[0]-i[0],t[1]=n[1]-i[1],t}function Y(t,n,i){return t[0]=n[0]*i,t[1]=n[1]*i,t}function Z(t){var n=t[0],i=t[1];return Math.sqrt(n*n+i*i)}function B(t,n){return t[0]*n[1]-t[1]*n[0]}new P,new P,new C,new C,new Uint8Array(4);var F=function(t){function n(n,i){var e;return void 0===n&&(n=0),void 0===i&&(i=n),p(e=t.call(this,n,i)||this)||p(e)}h(n,t);var i=n.prototype;return i.set=function(t,n){return void 0===n&&(n=t),t.length?this.copy(t):(function(t,n,i){t[0]=n,t[1]=i}(this,t,n),this)},i.copy=function(t){var n,i;return(n=this)[0]=(i=t)[0],n[1]=i[1],this},i.add=function(t,n){return n?X(this,t,n):X(this,this,t),this},i.sub=function(t,n){return n?z(this,t,n):z(this,this,t),this},i.multiply=function(t){var n,i;return t.length?((n=this)[0]=this[0]*(i=t)[0],n[1]=this[1]*i[1]):Y(this,this,t),this},i.divide=function(t){var n,i;return t.length?((n=this)[0]=this[0]/(i=t)[0],n[1]=this[1]/i[1]):Y(this,this,1/t),this},i.inverse=function(t){var n,i;return void 0===t&&(t=this),(n=this)[0]=1/(i=t)[0],n[1]=1/i[1],this},i.len=function(){return Z(this)},i.distance=function(t){return t?(i=(n=t)[0]-this[0],e=n[1]-this[1],Math.sqrt(i*i+e*e)):Z(this);var n,i,e},i.squaredLen=function(){return this.squaredDistance()},i.squaredDistance=function(t){return t?(i=(n=t)[0]-this[0])*i+(e=n[1]-this[1])*e:function(t){var n=t[0],i=t[1];return n*n+i*i}(this);var n,i,e},i.negate=function(t){var n,i;return void 0===t&&(t=this),(n=this)[0]=-(i=t)[0],n[1]=-i[1],this},i.cross=function(t,n){return n?B(t,n):B(this,t)},i.scale=function(t){return Y(this,this,t),this},i.normalize=function(){var t,n,i,e;return(e=(n=(t=this)[0])*n+(i=t[1])*i)>0&&(e=1/Math.sqrt(e)),this[0]=t[0]*e,this[1]=t[1]*e,this},i.dot=function(t){return this[0]*(n=t)[0]+this[1]*n[1];var n},i.equals=function(t){return this[0]===(n=t)[0]&&this[1]===n[1];var n},i.applyMatrix3=function(t){var n,i,e,r;return(n=this)[0]=(i=t)[0]*(e=this[0])+i[3]*(r=this[1])+i[6],n[1]=i[1]*e+i[4]*r+i[7],this},i.applyMatrix4=function(t){var n,i,e,r;return(n=this)[0]=(i=t)[0]*(e=this[0])+i[4]*(r=this[1])+i[12],n[1]=i[1]*e+i[5]*r+i[13],this},i.lerp=function(t,n){!function(t,n,i,e){var r=n[0],o=n[1];t[0]=r+e*(i[0]-r),t[1]=o+e*(i[1]-o)}(this,this,t,n)},i.clone=function(){return new n(this[0],this[1])},i.fromArray=function(t,n){return void 0===n&&(n=0),this[0]=t[n],this[1]=t[n+1],this},i.toArray=function(t,n){return void 0===t&&(t=[]),void 0===n&&(n=0),t[n]=this[0],t[n+1]=this[1],t},u(n,[{key:"x",get:function(){return this[0]},set:function(t){this[0]=t}},{key:"y",get:function(){return this[1]},set:function(t){this[1]=t}}]),n}(v(Array)),H=(new C,new F,new F,new F,new F,new F,new C,new C,new C,new C,new C,new C,new C,new C,new C,new C,new C,new P,new C,new C,new C,new C,new C,new U,new C,new C,new U,new C,new P,new C,new C,new C,new C,new C,new U,new U,new U,new U,new P,new P,{});i.forEach(function(t){H[t.type]=t});var G={};i.forEach(function(t){G[t.type]=t});var N,Q="",I=w("gen.plant"),J=function(t){return"object"==typeof t&&"type"in t};Object.defineProperty(exports,"ground",{enumerable:!0,get:function(){return n.ground}}),exports.plant=function(t,i){var r=function(t){var n=JSON.stringify(t);return n!==Q&&(Q=n,N=function(t){return{handleParameter:function(t,n){return n},getSetting:function(n){return t[n]},get seed(){return Math.random()},refresh:function(){return Math.random()}}}(t)),N}(i);console.log(t,r);var o=function t(n,i){I("skeleton."+n.type,n);var e={};return Object.entries(n.parameters).forEach(function(n){var r=n[1];e[n[0]]=J(r)?t(r,i):r}),n.parameters=e,n.result=function(t,n){return t.type in H?H[t.type].computeSkeleton(t,n):t.result}(n,i),I("skeleton."+n.type,n.result),n}(t,r);I("final skeleton",o);var s=function t(n,i){I("geometry."+n.type,n);var r={};return Object.entries(n.parameters).forEach(function(n){var e=n[1];r[n[0]]=J(e)?t(e,i):e}),n.parameters=r,n.result=e({},n.result,function(t,n){return t.type in G?G[t.type].computeGeometry(t,n):t.result}(n,i)),I("geometry."+n.type,n.result),n}(o,r);I("geo",s);var u=s.result;return u.geometry=n.calculateNormals(u.geometry),u};
//# sourceMappingURL=index.js.map
